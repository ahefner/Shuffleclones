This is a straightforward C++03 implementation, without Boost or C++11 features.
